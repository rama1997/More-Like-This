<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>More Like This Configuration</title>
		<link rel="stylesheet" href="styles.css" />
	</head>
	<body>
		<div class="container">
			<div class="header">
				<div class="addon-logo">
					<img src="https://i.imgur.com/DHKJ7dT.png" alt="More Like This Addon Logo" referrerpolicy="no-referrer" />
				</div>
				<h1>More Like This</h1>
				<div class="subtitle">RECOMMENDATIONS</div>
			</div>

			<div class="content">
				<div class="instructions">
					<p>
						Find movie and TV show recommendations right inside Stremio! This addon gathers recommendation for any title from multiple sources and brings them straight to your Stremio library. <br /><br />

						Getting started is easy — just add your own API keys for the recommendation sources you want to use. Need a key? Click the links under each input field to grab yours for free! You only need keys for the sources you want — for example, if you only want TMDB recommendations, you only need a TMDB key.<br /><br />

						If you have any questions, please visit the project's <a href="https://github.com/rama1997/More-Like-This">GitHub page</a> for the full instructions and tips.
					</p>
				</div>

				<form action="/saveConfig" method="POST">
					<div class="section-header">Recommendation Sources</div>

					<div class="form-group">
						<label for="tmdbApiKey">TMDB API Key</label>
						<p class="key-help">Get your free TMDB key <a href="https://www.themoviedb.org/settings/api" target="_blank">here</a></p>
						<div class="input-with-verify">
							<input type="text" id="tmdbApiKey" name="tmdbApiKey" placeholder="Enter TMDB API Key" />
							<button type="button" class="verify-btn" onclick="verifyApiKey('tmdb')">Verify Key</button>
							<input type="hidden" name="validatedTmdbApiKey" id="validatedTmdbApiKey" />
						</div>
						<div id="tmdb-verify-status" class="verify-status"></div>
					</div>

					<div class="toggle-group conditional-setting hidden" data-conditional="tmdbApiKey" data-show-if="not-empty">
						<div class="toggle-info">
							<span class="toggle-label">Include TMDB Collections in TMDB Recommendation</span>
							<div class="tooltip-container">
								<div class="tooltip-icon">?</div>
								<div class="tooltip-text">TMDB groups related movies, like sequels and series, into 'collections.' These movies are not always included in TMDB's default recommendations. Enable to add collection movies to the start of the TMDB recommendation list.</div>
							</div>
						</div>
						<label class="toggle">
							<input type="checkbox" id="includeTmdbCollection" name="includeTmdbCollection" />
							<span class="toggle-slider"></span>
						</label>
					</div>

					<div class="form-group">
						<label for="traktApiKey">Trakt API Key</label>
						<p class="key-help">Get your free Trakt key <a href="https://trakt.tv/oauth/applications" target="_blank">here</a></p>
						<div class="input-with-verify">
							<input type="text" id="traktApiKey" name="traktApiKey" placeholder="Enter Trakt API Key" />
							<button type="button" class="verify-btn" onclick="verifyApiKey('trakt')">Verify Key</button>
							<input type="hidden" name="validatedTraktApiKey" id="validatedTraktApiKey" />
						</div>
						<div id="trakt-verify-status" class="verify-status"></div>
					</div>

					<div class="form-group">
						<label for="geminiApiKey">Gemini AI API Key </label>
						<p class="key-help">Get your free Gemini AI key <a href="https://aistudio.google.com/app/apikey" target="_blank">here</a></p>
						<div class="input-with-verify">
							<input type="text" id="geminiApiKey" name="geminiApiKey" placeholder="Enter your Gemini AI key" />
							<button type="button" class="verify-btn" onclick="verifyApiKey('gemini')">Verify Key</button>
							<input type="hidden" name="validatedGeminiApiKey" id="validatedGeminiApiKey" />
						</div>
						<div id="gemini-verify-status" class="verify-status"></div>
					</div>

					<div class="form-group">
						<label for="tastediveApiKey">TasteDive API Key</label>
						<p class="key-help">Get your free TasteDive key <a href="https://tastedive.com/account/api_access" target="_blank">here</a></p>
						<div class="input-with-verify">
							<input type="text" id="tastediveApiKey" name="tastediveApiKey" placeholder="Enter TasteDive API Key" />
							<button type="button" class="verify-btn" onclick="verifyApiKey('tastedive')">Verify Key</button>
							<input type="hidden" name="validatedTastediveApiKey" id="validatedTastediveApiKey" />
						</div>
						<div id="tastedive-verify-status" class="verify-status"></div>
					</div>

					<div class="form-group">
						<label for="watchmodeApiKey">Watchmode API Key</label>
						<p class="key-help">Get your free Watchmode key <a href="https://api.watchmode.com/requestApiKey/" target="_blank">here</a></p>
						<div class="input-with-verify">
							<input type="text" id="watchmodeApiKey" name="watchmodeApiKey" placeholder="Enter Watchmode API Key" />
							<button type="button" class="verify-btn" onclick="verifyApiKey('watchmode')">Verify Key</button>
							<input type="hidden" name="validatedWatchmodeApiKey" id="validatedWatchmodeApiKey" />
						</div>
						<div id="watchmode-verify-status" class="verify-status"></div>
					</div>

					<div class="toggle-group">
						<div class="toggle-info">
							<span class="toggle-label">Simkl Recommendations</span>
							<div class="tooltip-container">
								<div class="tooltip-icon">?</div>
								<div class="tooltip-text">Simkl API does not require a key</div>
							</div>
						</div>
						<label class="toggle">
							<input type="checkbox" id="simkl" name="simkl" />
							<span class="toggle-slider"></span>
						</label>
					</div>

					<div class="section-header">Catalog Settings</div>

					<div class="toggle-group">
						<div class="toggle-info">
							<span class="toggle-label">Combine Into One Catalog</span>
							<div class="tooltip-container">
								<div class="tooltip-icon">?</div>
								<div class="tooltip-text">Combine recommendations from all sources into a single catalog, instead of showing them separately.</div>
							</div>
						</div>
						<label class="toggle">
							<input type="checkbox" id="combineCatalogs" name="combineCatalogs" />
							<span class="toggle-slider"></span>
						</label>
					</div>

					<div id="catalogOrderSection" class="catalog-order-section conditional-setting hidden" data-conditional="combineCatalogs" data-show-if="false">
						<div class="label-with-tooltip">
							<label>Catalog Order</label>
							<div class="tooltip-container">
								<div class="tooltip-icon">?</div>
								<div class="tooltip-text">Drag and drop to set the order of how recommendations catalog appears.</div>
							</div>
						</div>
						<div class="catalog-order">
							<div id="tmdb-catalog" class="catalog-item">
								<span class="catalog-icon">≡</span>
								<span class="catalog-name">TMDB</span>
							</div>
							<div id="trakt-catalog" class="catalog-item">
								<span class="catalog-icon">≡</span>
								<span class="catalog-name">Trakt</span>
							</div>
							<div id="simkl-catalog" class="catalog-item">
								<span class="catalog-icon">≡</span>
								<span class="catalog-name">Simkl</span>
							</div>
							<div id="gemini-catalog" class="catalog-item">
								<span class="catalog-icon">≡</span>
								<span class="catalog-name">Gemini AI</span>
							</div>
							<div id="tastedive-catalog" class="catalog-item">
								<span class="catalog-icon">≡</span>
								<span class="catalog-name">TasteDive</span>
							</div>
							<div id="watchmode-catalog" class="catalog-item">
								<span class="catalog-icon">≡</span>
								<span class="catalog-name">Watchmode</span>
							</div>
							<input type="hidden" name="catalogOrder" id="catalogOrder" value="TMDB,Trakt,Simkl,Gemini AI,TasteDive,Watchmode" />
						</div>
					</div>

					<div class="section-header">Optional Settings</div>

					<div class="dropdown-group">
						<div class="dropdown-info">
							<span class="dropdown-label">Metadata Source</span>
							<div class="tooltip-container">
								<div class="tooltip-icon">?</div>
								<div class="tooltip-text">By default, the addon gets metadata from Stremio's Cinemeta. Switch to TMDB to prioritize using TMDB's metadata. (Requires a TMDB API key.)</div>
							</div>
						</div>
						<div class="dropdown-container">
							<select id="metadataSource" name="metadataSource">
								<option value="cinemeta">Cinemeta (Default)</option>
								<option value="tmdb">TMDB (Requires TMDB API Key)</option>
							</select>
						</div>
					</div>

					<div class="dropdown-group conditional-setting hidden" data-conditional="metadataSource" data-show-if="tmdb">
						<div class="dropdown-info">
							<span class="dropdown-label">Language</span>
						</div>
						<div class="dropdown-container">
							<select id="language" name="language">
								<option value="en">English (Default)</option>
							</select>
						</div>
					</div>

					<div class="dropdown-group">
						<div class="dropdown-info">
							<span class="dropdown-label">Stream Button Platform</span>
							<div class="tooltip-container">
								<div class="tooltip-icon">?</div>
								<div class="tooltip-text">Change which platform's stream button shows up on each movie/tv show.</div>
							</div>
						</div>
						<div class="dropdown-container">
							<select id="streamButtonPlatform" name="streamButtonPlatform">
								<option value="both">Both (Default)</option>
								<option value="web">Web</option>
								<option value="app">App</option>
							</select>
						</div>
					</div>

					<div class="toggle-group">
						<div class="toggle-info">
							<span class="toggle-label">Enable Manual Title Searching</span>
							<div class="tooltip-container">
								<div class="tooltip-icon">?</div>
								<div class="tooltip-text">Enable to find recommendations based on movie or show titles too. (Note: Title-based searches may be less accurate than using the exact ID from Stremio.)</div>
							</div>
						</div>
						<label class="toggle">
							<input type="checkbox" id="enableTitleSearching" name="enableTitleSearching" checked />
							<span class="toggle-slider"></span>
						</label>
					</div>

					<div class="form-group">
						<label for="rpdbApiKey">RPDB API Key</label>
						<p class="key-help">Get your RPDB key <a href="https://ratingposterdb.com/api-key/" target="_blank">here</a></p>
						<div class="input-with-verify">
							<input type="text" id="rpdbApiKey" name="rpdbApiKey" placeholder="Enter your RPDB key" />
							<button type="button" class="verify-btn" onclick="verifyApiKey('rpdb')">Verify Key</button>
							<input type="hidden" name="validatedRpdbApiKey" id="validatedRpdbApiKey" />
						</div>
						<div id="rpdb-verify-status" class="verify-status"></div>
					</div>

					<input type="hidden" name="forCopy" id="forCopy" value="false" />

					<div class="button-group">
						<button type="submit" id="installBtn" class="install-button">Install</button>
						<button type="submit" id="copyManifestBtn" class="copy-manifest-button">Copy Manifest</button>
					</div>
				</form>
			</div>

			<div class="footer">To report issues or make suggestions, please visit the project page <a href="https://github.com/rama1997/More-Like-This">here</a>.</div>
		</div>

		<!-- Parse existing user config  -->
		<script>
			try {
				const params = new URLSearchParams(window.location.search);
				const configStr = params.get("data");

				if (configStr) {
					window.userConfig = JSON.parse(decodeURIComponent(configStr));
				}
			} catch (e) {
				window.userConfig = {};
			}
		</script>

		<script src="populateLanguages.js"></script>
		<script src="loadUserConfig.js"></script>
		<script src="apiKeyVerification.js"></script>
		<script src="conditionalSettings.js"></script>
		<script src="catalogOrder.js"></script>
		<script src="formSubmission.js"></script>
	</body>
</html>
